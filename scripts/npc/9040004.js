var Z = "#fUI/GuildMark.img/Mark/Letter/00005025/1#";
var Y = "#fUI/GuildMark.img/Mark/Letter/00005024/3#";
var X = "#fUI/GuildMark.img/Mark/Letter/00005023/1#";
var D = "#fUI/GuildMark.img/Mark/Letter/00005003/1#";
var M = "#fUI/GuildMark.img/Mark/Letter/00005012/1#";
var A = "#fUI/GuildMark.img/Mark/Letter/00005000/1#";
var P = "#fUI/GuildMark.img/Mark/Letter/00005015/1#";
var Z = "#fUI/GuildMark.img/Mark/Letter/00005025/9#";
var 箭头 = "#fUI/Basic/BtHide3/mouseOver/0#";
var 心 = "#fUI/GuildMark.img/Mark/Etc/00009001/13#";
var 心1 = "#fUI/GuildMark.img/Mark/Etc/00009001/8#";
var 蘑菇 = "#fUI/UIWindow.img/Minigame/Common/mark#";
var 红色箭头 = "#fEffect/CharacterEff/1112908/0/1#"; //彩光3
var 战斗力 = "#fUI/GuildMark/Mark/Etc/00009003/15#";
var 武器神秘力量 = "#fUI/GuildMark/Mark/Etc/00009023/1#";
var 宝石神秘力量 = "#fUI/GuildMark/Mark/Etc/00009023/13#";
var 点卷 = "#fUI/GuildMark/Mark/Pattern/00004014/1#";
var 抵用 = "#fUI/GuildMark/Mark/Pattern/00004014/5#";
var 冒险币 = "#fUI/GuildMark/Mark/Pattern/00004014/2#";
var 银行存款 = "#fUI/GuildMark/Mark/Pattern/00004014/3#";
var 消费余额 = "#fUI/GuildMark/Mark/Pattern/00004014/4#";
var 婚姻情况 = "#fUI/GuildMark/Mark/Plant/00003004/1#";
var 体力值 = "#fUI/GuildMark/Mark/Etc/00009001/14#";
var 每日充值 = "#fUI/GuildMark/Mark/Etc/00009022/10#";
var 累计充值 = "#fUI/GuildMark/Mark/Etc/00009022/1#";
var 黑果 = "#fUI/GuildMark.img/Mark/Etc/00009013/16#";
var 红圈 = "#fUI/Gateway.img/WorldSelect/select/3#";
var 黑冠 = "#fUI/GuildMark.img/Mark/Etc/00009004/16#";
var 红冠 = "#fUI/GuildMark.img/Mark/Etc/00009023/14#";
var 黑标 = "#fUI/GuildMark.img/Mark/Pattern/00004020/16#";
var 黑火 = "#fUI/GuildMark.img/Mark/Etc/00009018/16#";
var 黑点 = "#fUI/GuildMark.img/Mark/Etc/00009016/16#";
var 红圈 = "#fUI/Gateway.img/WorldSelect/select/3#";
var 黑冠 = "#fUI/GuildMark.img/Mark/Etc/00009004/16#";
var 红冠 = "#fUI/GuildMark.img/Mark/Etc/00009023/14#";
var 枫叶 = "#fUI/ITC.img/Base/Tab/Enable/0#";
var 金币 = "#fUI/Basic.img/BtCoin/normal/0#";
var 星星 = "#fUI/CN_Chat.img/roomList/Vip#";
var 图标 = "#fUI/Login.img/WorldSelect/world/t1#";
var 分割线 = "#fUI/Login.img/WorldSelect/channel/chgauge#";
var 金冠 = "#fUI/UIWindow.img/UserInfo/bossPetCrown#";
var 小星星 = "#fUI/UIWindow.img/UserList/Party/icon0#";
var 皇冠 = "#fUI/UIWindow.img/UserList/Guild/GuildRank/icon0#";
var 奖励 = "#fUI/UIWindow.img/Quest/reward#";
var 蓝包 = "#fUI/UIWindow.img/MonsterCarnival/icon2#";
var 绿Q标 = "#fUI/UIWindow.img/QuestAlarm/BtQ/ani/0#";
var 蓝箭头 = "#fUI/UIWindow.img/itemSearch/BtRight/normal/0#";
var 蓝R = "#fUI/UIWindow.img/Minigame/Common/readyOn#";
var 箱子 = "#fUI/UIWindow.img/Delivery/icon4#";
var 勋章 = "#fUI/UIWindow.img/MonsterBook/fullMark#";
var 红方 = "#fUI/UIWindow.img/AriantMatch/characterIcon/0#";
var 蓝方 = "#fUI/UIWindow.img/AriantMatch/characterIcon/1#";
var 绿方 = "#fUI/UIWindow.img/AriantMatch/characterIcon/2#";
var 黄方 = "#fUI/UIWindow.img/AriantMatch/characterIcon/3#";
var 紫方 = "#fUI/UIWindow.img/AriantMatch/characterIcon/4#";
var 橙方 = "#fUI/UIWindow.img/AriantMatch/characterIcon/5#";
var 进行中 = "#fUI/UIWindow.img/counsel/Loading/3#";
var 五子棋 = "#fUI/ChatBalloon.img/miniroom/Omok#";
var 斜金币 = "#fUI/ChatBalloon.img/miniroom/PersonalShop#";
var 熊猫 = "#fUI/ChatBalloon.img/pet/1/nw#";
var 毛球 = "#fUI/ChatBalloon.img/pet/12/nw#";
var 蓝条 = "#fUI/ChatBalloon.img/pet/19/head#";
var 蓝条条 = "#fUI/ChatBalloon.img/pet/28/head#";
var 蓝左头 = "#fUI/ChatBalloon.img/pet/19/nw#";
var 蓝右头 = "#fUI/ChatBalloon.img/pet/19/ne#";
var 蓝左下 = "#fUI/ChatBalloon.img/pet/28/nw#";
var 蓝右下 = "#fUI/ChatBalloon.img/pet/28/ne#";
var 蓝下条 = "#fUI/ChatBalloon.img/pet/28/arrow#";
var 蓝右下头 = "#fUI/ChatBalloon.img/pet/28/se#";
var 蓝左下头 = "#fUI/ChatBalloon.img/pet/28/sw#";
var 邮箱 = "#fUI/Basic.img/VScr6/enabled/thumb0#";
var 红V = "#fUI/Login.img/Title/check2/1#";
var 蓝升级 = "#fUI/Login.img/CharSelect/icon/up#";
var 黄N = "#fUI/Login.img/CharSelect/icon/new#";
var 蓝星 = "#fUI/GuildMark.img/Mark/Pattern/00004001/11#";
var 爱琴 = "#fUI/GuildMark.img/Mark/Pattern/00004007/14#";
var 蓝镖 = "#fUI/GuildMark.img/Mark/Pattern/00004014/11#";

function start() {
  status = -1;
  action(1, 0, 0);
}
function action(mode, type, selection) {
  if (status == 0 && mode == 0) {
    cm.dispose();
    return;
  }
  if (mode == 1) {
    status++;
  } else {
    status--;
  }
  cm.个人存档();
  var MC = cm.getServerName();
  var 名人榜开关 = cm.GetPiot("名人榜开关", "1");

  if (status == 0) {
    var selStr =
      "\t\t\t#e#r< " + 星星 + " 荣 耀 排 行 榜 " + 星星 + " >#k#n\r\n\r\n";
    selStr +=
      "\r\n" +
      红冠 +
      "" +
      红冠 +
      "" +
      红冠 +
      "" +
      红冠 +
      "" +
      黑冠 +
      "" +
      红冠 +
      "" +
      红冠 +
      "" +
      红冠 +
      "" +
      红冠 +
      "" +
      红冠 +
      "" +
      红冠 +
      "" +
      红冠 +
      "" +
      红冠 +
      "" +
      红冠 +
      "" +
      红冠 +
      "" +
      红冠 +
      "" +
      黑冠 +
      "" +
      红冠 +
      "" +
      红冠 +
      "" +
      红冠 +
      "" +
      红冠 +
      "\r\n";

    if (cm.GetPiot("名人榜开关", "1") <= 0) {
      selStr += "\t\t\t #L27##b" + 皇冠 + "战力排行榜" + 皇冠 + "#l\r\n";
      //selStr += "#L5##b"+皇冠+"玩家等级排行榜"+皇冠+"#l";
      //selStr += "#L2##b"+皇冠+"玩家财富排行榜"+皇冠+"#l\r\n";
      //selStr += "#L101##b"+皇冠+"玩家力量排行榜"+皇冠+"#l";
      //selStr += "#L102##b"+皇冠+"玩家敏捷排行榜"+皇冠+"#l\r\n";
      //selStr += "#L103##b"+皇冠+"玩家智力排行榜"+皇冠+"#l";
      //selStr += "#L104##b"+皇冠+"玩家运气排行榜"+皇冠+"#l\r\n";
      //
      //selStr += "#L19##b"+皇冠+"人气明星排行榜"+皇冠+"#l";
      //selStr += "#L13##b"+皇冠+"在线时长排行榜"+皇冠+"#l\r\n";

      // selStr += "#L19##b"+皇冠+"人气明星排行榜"+皇冠+"#l";
      //selStr += "\t\t\t\t#L25##b娱乐豆豆排行榜#l\r\n";
      // selStr += "#L13##b"+皇冠+"在线时常排行榜"+皇冠+"#l\r\n";

      //selStr += "\t\t\t#L26##b"+皇冠+"杀怪数量排行榜"+皇冠+"#l\r\n";
      //selStr += "\t\t\t\t#L29##b组队任务排行榜#l\r\n";
      //selStr += "\t\t\t\t#L52##b钓鱼积分排行榜#l\r\n";
      //selStr += "\t\t\t\t#L21##b五子棋积分排行#l\r\n";
      //selStr += "\t\t\t\t#L22##b记忆大考验排行#l\r\n\r\n";

      selStr +=
        "\r\n\r\n" +
        红冠 +
        "" +
        红冠 +
        "" +
        红冠 +
        "" +
        红冠 +
        "" +
        黑冠 +
        "" +
        红冠 +
        "" +
        红冠 +
        "" +
        红冠 +
        "" +
        红冠 +
        "" +
        红冠 +
        "" +
        红冠 +
        "" +
        红冠 +
        "" +
        红冠 +
        "" +
        红冠 +
        "" +
        红冠 +
        "" +
        红冠 +
        "" +
        黑冠 +
        "" +
        红冠 +
        "" +
        红冠 +
        "" +
        红冠 +
        "" +
        红冠 +
        "\r\n";
    } else {
      selStr += "\r\n维护中・・・";
      selStr += "\t\t\t\t#L666666##b返回界面#l";
    }
    if (cm.getPlayer().getGMLevel() == 6) {
      if (cm.GetPiot("名人榜开关", "1") <= 0) {
        selStr += "\r\n\t\t\t\t#L1000##b名人榜#g[开启中]#r[GM]#k#l";
      }
      if (cm.GetPiot("名人榜开关", "1") >= 1) {
        selStr += "\r\n\t\t\t\t#L1001##b名人榜#r[关闭中]#r[GM]#k#l";
      }
    }
    cm.sendSimple(selStr);
  } else if (status == 1) {
    switch (selection) {
      //玩家等级排行榜
      case 5111:
        var text = " ┌─────────< #e#r等  级#k#n >──────────┐#n\r\n";
        text +=
          "   #r提示：#b每日凌晨(维护)1:00,刷新等级前20名的玩家。#k\r\n\r\n";
        var rankinfo_list = cm.getBossRankCountTop10("等级排行");
        if (rankinfo_list != null) {
          for (var i = 0; i < rankinfo_list.size(); i++) {
            if (i == 20) {
              break;
            }
            var info = rankinfo_list.get(i);
            //显示名次
            text += i == 0 ? "#r" : i == 1 ? "#b" : i == 2 ? "#d" : "";
            text += "  \t\t\t\t#eTop." + (i + 1) + "#k#n\r\n";
            //t玩家名字
            text +=
              "  \t\t\t\t玩家名字:#b" +
              cm.角色ID取名字(info.getCid()) +
              "#k\r\n";
            //t玩家等级
            text += "  \t\t\t\t玩家等级:#b" + info.getCount() + "#k\r\n";
            //t玩家职业
            text +=
              "  \t\t\t\t玩家职业:#b" + cm.职业(info.getPoints()) + "#k\r\n";
            //t所属家族
            if (info.getCname() == 0) {
              text += "  \t\t\t\t所属家族:#b没有加入家族#k\r\n";
            } else {
              text +=
                "  \t\t\t\t所属家族:#b" +
                cm.获取家族名称(info.getCname()) +
                "#k\r\n";
            }
            text += "\r\n";
          }
        }
        text += " └────────────────────────┘#n\r\n\r\n";
        cm.sendOkS(text, 3);
        cm.dispose();
        break;

      //每日签到排行
      case 1:
        var text = " ┌─────────< #e#r签  到#k#n >──────────┐#n\r\n";
        text += "   #r提示：#b每日在小z签到的记录排行榜。#k\r\n\r\n";
        var rankinfo_list = cm.getBossRankCountTop("签到");
        if (rankinfo_list != null) {
          for (var i = 0; i < rankinfo_list.size(); i++) {
            if (i == 20) {
              break;
            }
            var info = rankinfo_list.get(i);

            text += i == 0 ? "#r" : i == 1 ? "#b" : i == 2 ? "#b" : "";
            text += "\tTop." + (i + 1) + "\t\t";
            // 填充名字空格
            text += info.getCname();
            for (var j = 16 - info.getCname().getBytes().length; j > 0; j--) {
              text += " ";
            }
            text += "\t\t#k#n签到#r #e" + info.getCount();
            text += "#k#n 天\t\t#k";
            text += "";
          }
        }
        text += "\r\n\r\n\r\n\r\n └────────────────────────┘#n\r\n\r\n";
        cm.sendOkS(text, 3);
        cm.dispose();
        break;
      //战斗力排行
      case 20:
        var text = " ┌─────────< #e#r战斗力#k#n >──────────┐#n\r\n";
        text += "   #r提示：#b战斗力是根据玩家自身属性的综合计算的。#k\r\n\r\n";
        var rankinfo_list = cm.getBossRankCountTop("战斗力统计");
        if (rankinfo_list != null) {
          for (var i = 0; i < rankinfo_list.size(); i++) {
            if (i == 20) {
              break;
            }
            var info = rankinfo_list.get(i);
            text += i == 0 ? "#r" : i == 1 ? "#b" : i == 2 ? "#b" : "";
            text += "\tTop." + (i + 1) + ".\t\t";
            // 填充名字空格
            text += info.getCname();
            for (var j = 16 - info.getCname().getBytes().length; j > 0; j--) {
              text += " ";
            }
            text += "\t\t战斗力:" + info.getCount();
            text += "\t#k";
            text += "";
          }
        }
        text += "\r\n\r\n\r\n\r\n └────────────────────────┘#n\r\n\r\n";
        cm.sendOkS(text, 3);
        cm.dispose();
        break;

      case 51:
        this.db = Packages.database.DatabaseConnection.getConnection();
        //数据库角色表杀怪数量字段 SG
        var sql =
          "select name,SG,gender from characters where gm<=0 order by SG desc limit 10;";
        var pstmt = db.prepareStatement(sql);
        var list = pstmt.executeQuery();
        var text = "\t\t\t\t#e#d★ 杀怪数量排行榜 ★#k#n\r\n\r\n";
        text += "\t#e名次#n\t#e玩家昵称#n\t\t  #e数量#n\t\t#e荣誉称号#n\r\n";
        for (var i = 1; i <= 10; i++) {
          if (!list.next()) {
            break;
          }
          if (i == 1) {
            text += "#r";
          } else if (i == 2) {
            text += "#g";
          } else if (i == 3) {
            text += "#b";
          }
          text += "\t " + i + "\t\t ";

          // 填充名字空格
          text += list.getString("name");
          for (
            var j = 16 - list.getString("name").getBytes().length;
            j > 0;
            j--
          ) {
            text += " ";
          }

          // 填充角色表杀怪数量字段
          text += "\t " + list.getInt("SG");
          var famevalues = list.getInt("SG");
          var famelength = 0;
          while (famevalues > 0) {
            famevalues = Math.floor(famevalues / 10);
            famelength += 1;
          }
          for (var j = 8 - famelength; j > 0; j--) {
            text += " ";
          }

          if (i == 1) {
            if (list.getInt("gender") == 0) {
              text += " ★世界偶像★#k";
            } else {
              text += " ★杀怪魔皇★#k";
            }
          } else if (i == 2) {
            text += " ★杀怪魔将★#k";
          } else if (i == 3) {
            text += "★杀怪魔兵★#k";
          }
          text += "\r\n";
        }
        list.close();
        pstmt.close();
        cm.sendOkS(text, 3);
        cm.dispose();

        break;

      case 52:
        this.db = Packages.database.DatabaseConnection.getConnection();
        //数据库角色表杀怪数量字段 SG
        var sql =
          "select name,钓鱼排名,gender from characters where gm<=0 order by 钓鱼排名 desc limit 10;";
        var pstmt = db.prepareStatement(sql);
        var list = pstmt.executeQuery();
        var text = "\t\t\t\t\t#e#d★ 钓鱼排行榜 ★#k#n\r\n\r\n";
        text += "\t#e名次#n\t#e玩家昵称#n\t\t  #e数量#n\t\t#e荣誉称号#n\r\n";
        for (var i = 1; i <= 10; i++) {
          if (!list.next()) {
            break;
          }
          if (i == 1) {
            text += "#r";
          } else if (i == 2) {
            text += "#r";
          } else if (i == 3) {
            text += "#r";
          } else if (i >= 4) {
            text += "#b";
          }
          text += "\t " + i + "\t\t ";

          // 填充名字空格
          text += list.getString("name");
          for (
            var j = 16 - list.getString("name").getBytes().length;
            j > 0;
            j--
          ) {
            text += " ";
          }

          // 填充角色表杀怪数量字段
          text += "\t " + list.getInt("钓鱼排名");
          var famevalues = list.getInt("钓鱼排名");
          var famelength = 0;
          while (famevalues > 0) {
            famevalues = Math.floor(famevalues / 10);
            famelength += 1;
          }
          for (var j = 8 - famelength; j > 0; j--) {
            text += " ";
          }

          if (i == 1) {
            if (list.getInt("gender") == 0) {
              text += " ★世界偶像★#k";
            } else {
              text += "★世界冠军★#k";
            }
          } else if (i == 2) {
            text += "★钓鱼达人★#k";
          } else if (i == 3) {
            text += "★钓鱼小白★#k";
          } else if (i >= 4) {
            text += "★钓鱼白痴★#k";
          }
          text += "\r\n";
        }
        list.close();
        pstmt.close();
        cm.sendOkS(text, 3);
        cm.dispose();

        break;

      case 53:
        this.db = Packages.database.DatabaseConnection.getConnection();
        //数据库角色表杀怪数量字段 SG
        var sql =
          "select name,组队排名,gender from characters where gm<=0 order by 组队排名 desc limit 10;";
        var pstmt = db.prepareStatement(sql);
        var list = pstmt.executeQuery();
        var text = "\t\t\t\t\t#e#d★ 组队任务排行榜 ★#k#n\r\n\r\n";
        text += "\t#e名次#n\t#e玩家昵称#n\t\t  #e数量#n\t\t#e荣誉称号#n\r\n";
        for (var i = 1; i <= 10; i++) {
          if (!list.next()) {
            break;
          }
          if (i == 1) {
            text += "#r";
          } else if (i == 2) {
            text += "#r";
          } else if (i == 3) {
            text += "#r";
          } else if (i >= 4) {
            text += "#b";
          }
          text += "\t " + i + "\t\t ";

          // 填充名字空格
          text += list.getString("name");
          for (
            var j = 16 - list.getString("name").getBytes().length;
            j > 0;
            j--
          ) {
            text += " ";
          }

          // 填充角色表杀怪数量字段
          text += "\t " + list.getInt("组队排名");
          var famevalues = list.getInt("组队排名");
          var famelength = 0;
          while (famevalues > 0) {
            famevalues = Math.floor(famevalues / 10);
            famelength += 1;
          }
          for (var j = 8 - famelength; j > 0; j--) {
            text += " ";
          }

          if (i == 1) {
            if (list.getInt("gender") == 0) {
              text += " ★世界偶像★#k";
            } else {
              text += "★任务偶像★#k";
            }
          } else if (i == 2) {
            text += "★任务达人★#k";
          } else if (i == 3) {
            text += "★任务新手★#k";
          } else if (i >= 4) {
            text += "★任务白痴★#k";
          }
          text += "\r\n";
        }
        list.close();
        pstmt.close();
        cm.sendOkS(text, 3);
        cm.dispose();

        break;

      case 4:
        selStr = "\t\t\t#e#r< 重 生 永 恒 排 行 榜 >#k#n\r\n\r\n";
        selStr += "" + cm.永恒重生排行榜() + "#k\r\n\r\n";
        cm.sendOkS(selStr, 3);
        cm.dispose();
        break;

      case 6:
        selStr = "\t\t\t\t#e#r< 满 级 排 行 榜 >#k#n\r\n\r\n";
        selStr +=
          "   这里是巅峰王者排行榜，都是岛上具有超凡实力的人。#k\r\n\r\n";
        selStr += "" + cm.满级排行榜() + "\r\n";
        cm.sendOkS(selStr, 3);
        cm.dispose();
        break;

      case 1000:
        cm.GainPiot("名人榜开关", "1", -名人榜开关);
        cm.GainPiot("名人榜开关", "1", 1);
        cm.sendOkS("名人榜关闭成功", 3);
        cm.dispose();
        break;
      case 1001:
        cm.GainPiot("名人榜开关", "1", -名人榜开关);
        cm.sendOkS("名人榜打开成功", 3);
        cm.dispose();
        break;
      case 21:
        cm.dispose();
        cm.openNpc(9040004, 1);
        break;
      case 22:
        cm.dispose();
        cm.openNpc(9040004, 2);
      case 29:
        cm.dispose();
        cm.openNpc(9040004, 7008);
        break;
      case 666666:
        cm.dispose();
        cm.openNpc(9900004, 0);
        break;
      case 0:
        cm.displayGuildRanks();
        cm.dispose();
        break;
      case 9:
        cm.MapleMSpvpdeaths();
        cm.dispose();
        break;
      case 25:
        cm.声望排行榜();
        cm.dispose();
        break;
      case 26:
        cm.杀怪排行榜();
        cm.dispose();
        break;
      case 27:
        cm.dispose();
        cm.openNpc(9900004, "全服战力排行榜");
        break;
      case 101:
        cm.力量排行榜_snail();
        cm.dispose();
        break;
      case 102:
        cm.敏捷排行榜_snail();
        cm.dispose();
        break;
      case 103:
        cm.智力排行榜_snail();
        cm.dispose();
        break;
      case 104:
        cm.运气排行榜_snail();
        cm.dispose();
        break;
      case 28:
        cm.钓鱼积分排行榜();
        cm.dispose();
        break;
      case 19:
        cm.人气排行榜();
        cm.dispose();
        break;
      case 23:
        cm.豆豆排行榜();
        cm.dispose();
        break;
      case 13:
        cm.总在线时间排行榜();
        cm.dispose();
        break;
      case 10:
        cm.MapleMSpvpkills();
        cm.dispose();
        break;
      case 5:
        cm.showlvl_s();
        cm.dispose();
        break;

      case 2:
        cm.showmeso_s();
        cm.dispose();
        break;
    }
  }
}
function getname(id) {
  var con1 = DatabaseConnection.getConnection();
  ps1 = con1.prepareStatement("SELECT name FROM characters WHERE id = ?");
  ps1.setInt(1, id);
  var rs1 = ps1.executeQuery();
  var name;
  if (rs1.next()) {
    name = rs1.getString("name");
  } else {
    name = "无名";
  }
  rs1.close();
  ps1.close();
  return name;
}
