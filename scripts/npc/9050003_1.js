/*
 ZEVMS冒险岛(079)游戏服务端
 对应的蛋：4170002
 */
var 蛋 = 4170002;
var status = 0;
//物品ID，抽奖概率，物品数量，(0/不广播，1广播)
var itemList =
        Array(
						Array(1302002, 1000, 1, 1),
				Array(1302003, 1000, 1, 1),
				Array(1302004, 1000, 1, 1),
				Array(1302005, 1000, 1, 1),
				Array(1302006, 1000, 1, 1),
				Array(1302007, 1000, 1, 1),
				Array(1302008, 1000, 1, 1),
				Array(1302009, 1000, 1, 1),
				Array(1302010, 1000, 1, 1),
				Array(1302011, 1000, 1, 1),
				Array(1302012, 1000, 1, 1),
				Array(1302013, 1000, 1, 1),
				Array(1302014, 1000, 1, 1),
				Array(1302015, 1000, 1, 1),
				Array(1302016, 1000, 1, 1),
				Array(1302017, 1000, 1, 1),
				Array(1302018, 1000, 1, 1),
				Array(1302019, 100, 1, 1),
				Array(1302020, 1000, 1, 1),
				Array(1302021, 100, 1, 1),
				Array(1302022, 1000, 1, 1),
				Array(1302023, 1000, 1, 1),
				Array(1302024, 200, 1, 1),
				Array(1302025, 500, 1, 1),
				Array(1302026, 50, 1, 1),
				Array(1302027, 500, 1, 1),
				Array(1302028, 300, 1, 1),
				Array(1302029, 200, 1, 1),
				Array(1302032, 1000, 1, 1),
				Array(1302037, 1000, 1, 1),
				Array(1302038, 1000, 1, 1),
				Array(1302039, 1000, 1, 1),
				Array(1302040, 1000, 1, 1),
				Array(1302041, 1000, 1, 1),
				Array(1302042, 1000, 1, 1),
				Array(1302043, 1000, 1, 1),
				Array(1302044, 1000, 1, 1),
				Array(1302045, 1000, 1, 1),
				Array(1302046, 1000, 1, 1),
				Array(1302047, 1000, 1, 1),
				Array(1302049, 300, 1, 1),
				Array(1302050, 1000, 1, 1),
				Array(1302051, 1000, 1, 1),
				Array(1302052, 1000, 1, 1),
				Array(1302053, 1000, 1, 1),
				Array(1302054, 1000, 1, 1),
				Array(1302055, 1000, 1, 1),
				Array(1302056, 1000, 1, 1),
				Array(1302057, 1000, 1, 1),
				Array(1302058, 1000, 1, 1),
				Array(1302059, 1000, 1, 1),
				Array(1302060, 1000, 1, 1),
				Array(1302063, 30, 1, 1),
				Array(1302064, 1000, 1, 1),
				Array(1302071, 1000, 1, 1),
				Array(1302084, 1000, 1, 1),
				Array(1302085, 1000, 1, 1),
				Array(1302087, 1000, 1, 1),
				Array(1302104, 800, 1, 1),
				Array(1302128, 1000, 1, 1),
				Array(1302129, 1000, 1, 1),
				Array(1312009, 1000, 1, 1),
				Array(1312010, 1000, 1, 1),
				Array(1312011, 1000, 1, 1),//
				Array(1312012, 1000, 1, 1),
				Array(1312013, 600, 1, 1),
				Array(1312014, 600, 1, 1),
				Array(1312015, 1000, 1, 1),
				Array(1312016, 1000, 1, 1),
				Array(1312017, 1000, 1, 1),
				Array(1312018, 1000, 1, 1),
				Array(1312019, 1000, 1, 1),
				Array(1312020, 1000, 1, 1),
				Array(1312021, 1000, 1, 1),
				Array(1312022, 1000, 1, 1),
				Array(1312023, 1000, 1, 1),
				Array(1312024, 1000, 1, 1),
				Array(1312034, 1000, 1, 1),
				Array(1322003, 1000, 1, 1),
				Array(1322012, 1000, 1, 1),
				Array(1322021, 1000, 1, 1),
				Array(1322022, 1000, 1, 1),
				Array(1322023, 1000, 1, 1),
				Array(1322024, 1000, 1, 1),
				Array(1322025, 1000, 1, 1),
				Array(1322026, 1000, 1, 1),
				Array(1322027, 1000, 1, 1),
				Array(1322051, 500, 1, 1),
				Array(1322056, 1000, 1, 1),
				Array(1332003, 1000, 1, 1),
				Array(1332020, 1000, 1, 1),
				Array(1332021, 1000, 1, 1),
				Array(1332054, 1000, 1, 1),
				Array(1372008, 1000, 1, 1),
				Array(1372010, 1000, 1, 1),
				Array(1372017, 1000, 1, 1),
				Array(1372031, 1000, 1, 1),
				Array(1372032, 1000, 1, 1),
				Array(1372033, 1000, 1, 1),
				Array(1372034, 1000, 1, 1),
				Array(1382015, 1000, 1, 1),
				Array(1382016, 1000, 1, 1),
				Array(1382037, 1000, 1, 1),
				Array(1382039, 1000, 1, 1),
				Array(1402005, 1000, 1, 1),
				Array(1402005, 1000, 1, 1),
				Array(1402007, 1000, 1, 1),
				Array(1402009, 1000, 1, 1),
				Array(1402013, 1000, 1, 1),
				Array(1402014, 500, 1, 1),
				Array(1402029, 500, 1, 1),
				Array(1402035, 1000, 1, 1),
				Array(1402037, 100, 1, 1),
				Array(1402044, 1000, 1, 1),
				Array(1402063, 100, 1, 1),
				Array(1412021, 1000, 1, 1),
				Array(1422011, 1000, 1, 1),
				Array(1422036, 1000, 1, 1),
				Array(1432008, 1000, 1, 1),
				Array(1432009, 1000, 1, 1),
				Array(1432010, 300, 1, 1),
				Array(1432011, 1000, 1, 1),
				Array(1432013, 1000, 1, 1),
				Array(1432014, 1000, 1, 1),
				Array(1432015, 1000, 1, 1),
				Array(1432016, 1000, 1, 1),
				Array(1432017, 1000, 1, 1),
				Array(1432018, 1000, 1, 1),
				Array(1432023, 1000, 1, 1),
				Array(1432039, 1000, 1, 1),
				Array(1432048, 1000, 1, 1),
				Array(1442011, 1000, 1, 1),
				Array(1442012, 1000, 1, 1),
				Array(1442013, 1000, 1, 1),
				Array(1442014, 1000, 1, 1),
				Array(1442015, 1000, 1, 1),
				Array(1442016, 1000, 1, 1),
				Array(1442017, 1000, 1, 1),
				Array(1442018, 200, 1, 1),
				Array(1442021, 500, 1, 1),
				Array(1442022, 500, 1, 1),
				Array(1442023, 600, 1, 1),
				Array(1442026, 1000, 1, 1),
				Array(1442027, 1000, 1, 1),
				Array(1442028, 1000, 1, 1),
				Array(1442029, 1000, 1, 1),
				Array(1442030, 1000, 1, 1),
				Array(1442039, 200, 1, 1),
				Array(1442046, 600, 1, 1),
				Array(1442054, 1000, 1, 1),
				Array(1442055, 1000, 1, 1),
				Array(1442056, 1000, 1, 1),
				Array(1442057, 1000, 1, 1),
				Array(1442065, 1000, 1, 1),
				Array(1442066, 1000, 1, 1),
				Array(1442069, 1000, 1, 1),
				Array(1442070, 1000, 1, 1),
				Array(1452009, 1000, 1, 1),
				Array(1452010, 1000, 1, 1),
				Array(1452011, 1000, 1, 1),
				Array(1452012, 1000, 1, 1),
				Array(1452013, 1000, 1, 1),
				Array(1452014, 1000, 1, 1),
				Array(1452015, 1000, 1, 1),
				Array(1452016, 1000, 1, 1),
				Array(1452071, 1000, 1, 1),
				Array(1462009, 1000, 1, 1),
				Array(1462010, 1000, 1, 1),
				Array(1462011, 1000, 1, 1),
				Array(1462012, 1000, 1, 1),
				Array(1462013, 1000, 1, 1),
				Array(1462014, 1000, 1, 1),
				Array(1462032, 1000, 1, 1),
				Array(1462039, 1000, 1, 1),
				Array(1472026, 1000, 1, 1),
				Array(1472027, 1000, 1, 1),
				Array(1472028, 1000, 1, 1),
				Array(1472029, 1000, 1, 1),
				Array(1472086, 1000, 1, 1),
				Array(1482022, 1000, 1, 1),
				Array(1492013, 1000, 1, 1),
				Array(1492012, 1000, 1, 1),
				Array(1492011, 1000, 1, 1),
				Array(1492037, 1000, 1, 1),
				Array(1002080, 500, 1, 1),
				Array(1002081, 500, 1, 1),
				Array(1002082, 500, 1, 1),
				Array(1002083, 500, 1, 1),
				Array(1002247, 500, 1, 1),
				Array(1002248, 500, 1, 1),
				Array(1002249, 500, 1, 1),
				Array(1002245, 500, 1, 1),
				Array(1002242, 500, 1, 1),
				Array(1002252, 500, 1, 1),
				Array(1002278, 500, 1, 1),
				Array(1002281, 500, 1, 1),
				Array(1002340, 500, 1, 1),
				Array(1002363, 500, 1, 1),
				Array(1002330, 500, 1, 1),
				Array(1002378, 500, 1, 1),
				Array(1002382, 500, 1, 1),
				Array(1002391, 500, 1, 1),
				Array(1002392, 500, 1, 1),
				Array(1002393, 500, 1, 1),
				Array(1002394, 500, 1, 1),
				Array(1002395, 500, 1, 1),
				Array(1002511, 500, 1, 1),
				Array(1002585, 500, 1, 1),
				Array(1002586, 500, 1, 1),
				Array(1002587, 500, 1, 1),
				Array(1002677, 500, 1, 1),
				Array(1002699, 500, 1, 1),
				Array(1002707, 500, 1, 1),
				Array(1102000, 500, 1, 1),
				Array(1102001, 500, 1, 1),
				Array(1102002, 500, 1, 1),
				Array(1102003, 500, 1, 1),
				Array(1102004, 500, 1, 1),
				Array(1102040, 500, 1, 1),
				Array(1102041, 500, 1, 1),
				Array(1102042, 500, 1, 1),
				Array(1102043, 500, 1, 1),
                Array(2000000, 1000, 1, 1),
				Array(2000000, 1200, 1, 1),
				Array(2000005, 1300, 5, 1),
				Array(2000004, 1400, 3, 1),
				Array(2000005, 1500, 2, 1),
				Array(2000000, 1600, 1, 1),
				Array(2000005, 1700, 1, 1),
				Array(2000003, 1800, 5, 1),
				Array(2000002, 1900, 3, 1),
				Array(2000001, 2000, 2, 1),
                Array(2000001, 1000, 1, 1),
                Array(2000002, 1000, 1, 1),
                Array(2000003, 1000, 1, 1),
				Array(2000004, 300, 1, 1),
                Array(2000005, 100, 1, 1),
                Array(2000000, 1000, 1, 1),
                Array(2000001, 1000, 1, 1),
                Array(2000002, 1000, 1, 1),
                Array(2000003, 1000, 1, 1),
				Array(2000004, 300, 1, 1),
                Array(2000005, 100, 1, 1)
				
                );

function start() {
    status = -1;
    action(1, 0, 0);
}

function action(mode, type, selection) {
    if (mode == 1) {
        status++;
    } else {
        if (status == 0) {
            cm.sendOk("你没有 " + cm.显示物品(5220040) + " ？");
            cm.dispose();
        }
        status--;
    }
    if (status == 0) {
        if (cm.haveItem(5220040, 1)) {
            var str1 = "";
            for (var i = 0; i < itemList.length; i++) {
                str1 += "#v" + itemList[i][0] + "#";
            }
            cm.sendYesNo("我是#b"+城镇+"#k的飞天猪，你好 #b#h ##k 给我 " + cm.显示物品(5220040) + " 就可以抽奖了。");
        } else {
            var str1 = "\r\n";
            for (var i = 0; i < itemList.length; i++) {
                str1 += "#v" + itemList[i][0] + "#";
            }
            cm.sendOk("我是#b"+城镇+"#k的飞天猪，你没有 " + cm.显示物品(5220040) + " ! 等你有了在来找我把。");
            cm.safeDispose();
        }
    } else if (status == 1) {
        var chance = Math.floor(Math.random() * +100);
        var finalitem = Array();
        for (var i = 0; i < itemList.length; i++) {
            if (itemList[i][1] >= chance) {
                finalitem.push(itemList[i]);
            }
        }
        if (finalitem.length != 0) {
            if (finalitem.length == 0) {
                return 1;
            }
            var item;
            var random = new java.util.Random();
            var finalchance = random.nextInt(finalitem.length);
            var itemId = finalitem[finalchance][0];
            var quantity = finalitem[finalchance][2];
            var notice = finalitem[finalchance][3];
            item = cm.gainGachaponItem(itemId, quantity, "飞天猪", notice);
            if (item != -1) {
                cm.gainItem(5220040, -1);
                cm.sendOk("你获得了 " + cm.显示物品(item) + " x #b"+quantity+"#k");
            } else {
                cm.sendOk("请你确认在背包的装备，消耗，其他窗口中是否有一格以上的空间。");
            }
            cm.safeDispose();
        } else {
            cm.sendOk("今天的运气可真差，什么都没有拿到。");
            cm.safeDispose();
        }
        cm.safeDispose();
    }
}