/*
 ZEVMS冒险岛(079)游戏服务端
 永恒的谜之蛋
 4280000
 5490000
 */
var status = 0;
//物品ID，抽奖概率，物品数量，(0/不广播，1广播)
var itemList =
        Array(	
				Array(1302002, 1000, 1, 1),
				Array(1302003, 1000, 1, 1),
				Array(1302004, 1000, 1, 1),
				Array(1302005, 1000, 1, 1),
				Array(1302006, 1000, 1, 1),
				Array(1302007, 1000, 1, 1),
				Array(1302008, 1000, 1, 1),
				Array(1302009, 1000, 1, 1),
				Array(1302010, 1000, 1, 1),
				Array(1302011, 1000, 1, 1),
				Array(1302012, 1000, 1, 1),
				Array(1302013, 1000, 1, 1),
				Array(1302014, 1000, 1, 1),
				Array(1302015, 1000, 1, 1),
				Array(1302016, 1000, 1, 1),
				Array(1302017, 1000, 1, 1),
				Array(1302018, 1000, 1, 1),
				Array(1302019, 100, 1, 1),
				Array(1302020, 1000, 1, 1),
				Array(1302021, 100, 1, 1),
				Array(1302022, 1000, 1, 1),
				Array(1302023, 1000, 1, 1),
				Array(1302024, 200, 1, 1),
				Array(1302025, 500, 1, 1),
				Array(1302026, 50, 1, 1),
				Array(1302027, 500, 1, 1),
				Array(1302028, 300, 1, 1),
				Array(1302029, 200, 1, 1),
				Array(1302032, 1000, 1, 1),
				Array(1302037, 1000, 1, 1),
				Array(1302038, 1000, 1, 1),
				Array(1302039, 1000, 1, 1),
				Array(1302040, 1000, 1, 1),
				Array(1302041, 1000, 1, 1),
				Array(1302042, 1000, 1, 1),
				Array(1302043, 1000, 1, 1),
				Array(1302044, 1000, 1, 1),
				Array(1302045, 1000, 1, 1),
				Array(1302046, 1000, 1, 1),
				Array(1302047, 1000, 1, 1),
				Array(1302049, 300, 1, 1),
				Array(1302050, 1000, 1, 1),
				Array(1302051, 1000, 1, 1),
				Array(1302052, 1000, 1, 1),
				Array(1302053, 1000, 1, 1),
				Array(1302054, 1000, 1, 1),
				Array(1302055, 1000, 1, 1),
				Array(1302056, 1000, 1, 1),
				Array(1302057, 1000, 1, 1),
				Array(1302058, 1000, 1, 1),
				Array(1302059, 1000, 1, 1),
				Array(1302060, 1000, 1, 1),
				Array(1302063, 30, 1, 1),
				Array(1302064, 1000, 1, 1),
				Array(1302071, 1000, 1, 1),
				Array(1302084, 1000, 1, 1),
				Array(1302085, 1000, 1, 1),
				Array(1302087, 1000, 1, 1),
				Array(1302104, 800, 1, 1),
				Array(1302128, 1000, 1, 1),
				Array(1302129, 1000, 1, 1),
				Array(1312009, 1000, 1, 1),
				Array(1312010, 1000, 1, 1),
				Array(1312011, 1000, 1, 1),
				Array(1312012, 1000, 1, 1),
				Array(1312013, 600, 1, 1),
				Array(1312014, 600, 1, 1),
				Array(1312015, 1000, 1, 1),
				Array(1312016, 1000, 1, 1),
				Array(1312017, 1000, 1, 1),
				Array(1312018, 1000, 1, 1),
				Array(1312019, 1000, 1, 1),
				Array(1312020, 1000, 1, 1),
				Array(1312021, 1000, 1, 1),
				Array(1312022, 1000, 1, 1),
				Array(1312023, 1000, 1, 1),
				Array(1312024, 1000, 1, 1),
				Array(1312034, 1000, 1, 1),
				Array(1322003, 1000, 1, 1),
				Array(1322012, 1000, 1, 1),
				Array(1322021, 1000, 1, 1),
				Array(1322022, 1000, 1, 1),
				Array(1322023, 1000, 1, 1),
				Array(1322024, 1000, 1, 1),
				Array(1322025, 1000, 1, 1),
				Array(1322026, 1000, 1, 1),
				Array(1322027, 1000, 1, 1),
				Array(1322051, 500, 1, 1),
				Array(1322056, 1000, 1, 1),
				Array(1332003, 1000, 1, 1),
				Array(1332020, 1000, 1, 1),
				Array(1332021, 1000, 1, 1),
				Array(1332054, 1000, 1, 1),
				Array(1372008, 1000, 1, 1),
				Array(1372010, 1000, 1, 1),
				Array(1372017, 1000, 1, 1),
				Array(1372031, 1000, 1, 1),
				Array(1372032, 1000, 1, 1),
				Array(1372033, 1000, 1, 1),
				Array(1372034, 1000, 1, 1),
				Array(1382015, 1000, 1, 1),
				Array(1382016, 1000, 1, 1),
				Array(1382037, 1000, 1, 1),
				Array(1382039, 1000, 1, 1),
				Array(1402005, 1000, 1, 1),
				Array(1402005, 1000, 1, 1),
				Array(1402007, 1000, 1, 1),
				Array(1402009, 1000, 1, 1),
				Array(1402013, 1000, 1, 1),
				Array(1402014, 500, 1, 1),
				Array(1402029, 500, 1, 1),
				Array(1402035, 1000, 1, 1),
				Array(1402037, 100, 1, 1),
				Array(1402044, 1000, 1, 1),
				Array(1402063, 100, 1, 1),
				Array(1412021, 1000, 1, 1),
				Array(1422011, 1000, 1, 1),
				Array(1422036, 1000, 1, 1),
				Array(1432008, 1000, 1, 1),
				Array(1432009, 1000, 1, 1),
				Array(1432010, 300, 1, 1),
				Array(1432011, 1000, 1, 1),
				Array(1432013, 1000, 1, 1),
				Array(1432014, 1000, 1, 1),
				Array(1432015, 1000, 1, 1),
				Array(1432016, 1000, 1, 1),
				Array(1432017, 1000, 1, 1),
				Array(1432018, 1000, 1, 1),
				Array(1432023, 1000, 1, 1),
				Array(1432039, 1000, 1, 1),
				Array(1432048, 1000, 1, 1),
				Array(1442011, 1000, 1, 1),
				Array(1442012, 1000, 1, 1),
				Array(1442013, 1000, 1, 1),
				Array(1442014, 1000, 1, 1),
				Array(1442015, 1000, 1, 1),
				Array(1442016, 1000, 1, 1),
				Array(1442017, 1000, 1, 1),
				Array(1442018, 200, 1, 1),
				Array(1442021, 500, 1, 1),
				Array(1442022, 500, 1, 1),
				Array(1442023, 600, 1, 1),
				Array(1442026, 1000, 1, 1),
				Array(1442027, 1000, 1, 1),
				Array(1442028, 1000, 1, 1),
				Array(1442029, 1000, 1, 1),
				Array(1442030, 1000, 1, 1),
				Array(1442039, 200, 1, 1),
				Array(1442046, 600, 1, 1),
				Array(1442054, 1000, 1, 1),
				Array(1442055, 1000, 1, 1),
				Array(1442056, 1000, 1, 1),
				Array(1442057, 1000, 1, 1),
				Array(1442065, 1000, 1, 1),
				Array(1442066, 1000, 1, 1),
				Array(1442069, 1000, 1, 1),
				Array(1442070, 1000, 1, 1),
				Array(1452009, 1000, 1, 1),
				Array(1452010, 1000, 1, 1),
				Array(1452011, 1000, 1, 1),
				Array(1452012, 1000, 1, 1),
				Array(1452013, 1000, 1, 1),
				Array(1452014, 1000, 1, 1),
				Array(1452015, 1000, 1, 1),
				Array(1452016, 1000, 1, 1),
				Array(1452071, 1000, 1, 1),
				Array(1462009, 1000, 1, 1),
				Array(1462010, 1000, 1, 1),
				Array(1462011, 1000, 1, 1),
				Array(1462012, 1000, 1, 1),
				Array(1462013, 1000, 1, 1),
				Array(1462014, 1000, 1, 1),
				Array(1462032, 1000, 1, 1),
				Array(1462039, 1000, 1, 1),
				Array(1472026, 1000, 1, 1),
				Array(1472027, 1000, 1, 1),
				Array(1472028, 1000, 1, 1),
				Array(1472029, 1000, 1, 1),
				Array(1472086, 1000, 1, 1),
				Array(1482022, 1000, 1, 1),
				Array(1492013, 1000, 1, 1),
				Array(1492012, 1000, 1, 1),
				Array(1492011, 1000, 1, 1),
				Array(1492037, 1000, 1, 1),
				Array(1442054, 1000, 1, 1),
				Array(1442055, 1000, 1, 1),
				Array(1442056, 1000, 1, 1),
				Array(1442057, 1000, 1, 1),
				Array(1442065, 1000, 1, 1),
				Array(1442066, 1000, 1, 1),
				Array(1442069, 1000, 1, 1),
				Array(1442070, 1000, 1, 1),
				Array(1452009, 1000, 1, 1),
				Array(1452010, 1000, 1, 1),
				Array(1452011, 1000, 1, 1),
				Array(1452012, 1000, 1, 1),
				Array(1452013, 1000, 1, 1),
				Array(1452014, 1000, 1, 1),
				Array(1452015, 1000, 1, 1),
				Array(1452016, 1000, 1, 1),
				Array(1452071, 1000, 1, 1),
				Array(1462009, 1000, 1, 1),
				Array(1462010, 1000, 1, 1),
				Array(1462011, 1000, 1, 1),
				Array(1462012, 1000, 1, 1),
				Array(1462013, 1000, 1, 1),
				Array(1462014, 1000, 1, 1),
				Array(1462032, 1000, 1, 1),
				Array(1462039, 1000, 1, 1),
				Array(1472026, 1000, 1, 1),
				Array(1472027, 1000, 1, 1),
				Array(1472028, 1000, 1, 1),
				Array(1472029, 1000, 1, 1),
				Array(1472086, 1000, 1, 1),
				Array(1482022, 1000, 1, 1),
				Array(1492013, 1000, 1, 1),
				Array(1492012, 1000, 1, 1),
				Array(1492011, 1000, 1, 1),
				Array(1492037, 1000, 1, 1),
				Array(1002080, 500, 1, 1),
				Array(1002081, 500, 1, 1),
				Array(1002082, 500, 1, 1),
				Array(1002083, 500, 1, 1),
				Array(1002247, 500, 1, 1),
				Array(1002248, 500, 1, 1),
				Array(1002249, 500, 1, 1),
				Array(1002245, 500, 1, 1),
				Array(1002242, 500, 1, 1),
				Array(1002252, 500, 1, 1),
				Array(1002278, 500, 1, 1),
				Array(1002281, 500, 1, 1),
				Array(1002340, 500, 1, 1),
				Array(1002363, 500, 1, 1),
				Array(1002330, 500, 1, 1),
				Array(1002378, 500, 1, 1),
				Array(1002382, 500, 1, 1),
				Array(1002391, 500, 1, 1),
				Array(1002392, 500, 1, 1),
				Array(1002393, 500, 1, 1),
				Array(1002394, 500, 1, 1),
				Array(1002395, 500, 1, 1),
				Array(1002511, 500, 1, 1),
				Array(1002585, 500, 1, 1),
				Array(1002586, 500, 1, 1),
				Array(1002587, 500, 1, 1),
				Array(1002677, 500, 1, 1),
				Array(1002699, 500, 1, 1),
				Array(1002707, 500, 1, 1),
				Array(1102000, 500, 1, 1),
				Array(1102001, 500, 1, 1),
				Array(1102002, 500, 1, 1),
				Array(1102003, 500, 1, 1),
				Array(1102004, 500, 1, 1),
				Array(1102040, 500, 1, 1),
				Array(1102041, 500, 1, 1),
				Array(1102042, 500, 1, 1),
				Array(1102043, 500, 1, 1),
				Array(1372042, 500, 1, 1),
				Array(1372041, 500, 1, 1),
				Array(1372039, 500, 1, 1),
				Array(1372035, 500, 1, 1),
				Array(1382048, 500, 1, 1),
				Array(1382047, 500, 1, 1),
				Array(1372037, 500, 1, 1),
				Array(1372038, 500, 1, 1),
				Array(1382046, 500, 1, 1),
				Array(1372036, 500, 1, 1),
				Array(1382045, 500, 1, 1),
				Array(1382049, 500, 1, 1),
				Array(1382052, 500, 1, 1),
				Array(1382051, 500, 1, 1),
				Array(1382050, 500, 1, 1),
				Array(4006000, 1100, 10, 1),
				Array(4006001, 1100, 10, 1),
				Array(2000001, 1100, 10, 1),
				Array(2000002, 1100, 10, 1),
				Array(2000003, 1100, 10, 1),
				Array(2000004, 1100, 10, 1),
				Array(2000005, 1100, 10, 1),
				/*************
				手套
				*************/
				//永恒定边手套
                Array(1082234, 50, 1, 1),
				//永恒逍遥手套
                Array(1082235, 50, 1, 1),
				//永恒白云手套
                Array(1082236, 50, 1, 1),
				//永恒探云手套
                Array(1082237, 50, 1, 1),
				//永恒抚浪手套
                Array(1082238, 50, 1, 1),
				/*************
				鞋子
				*************/
				//永恒坚壁靴
                /*Array(1072355, 50, 1, 1),
				//永恒缥缈鞋
                Array(1072356, 50, 1, 1),
				//永恒彩虹鞋
                Array(1072357, 50, 1, 1),
				//永恒舞空靴
                Array(1072358, 50, 1, 1),
				//永恒定海靴
                Array(1072359, 50, 1, 1),*/
				/*************
				套服
				*************/
				//永恒演武铠
                /*Array(1052155, 50, 1, 1),
				//永恒奥神袍
                Array(1052156, 50, 1, 1),
				//永恒巡礼者
                Array(1052157, 50, 1, 1),
				//永恒翻云服
                Array(1052158, 50, 1, 1),
				//永恒霸七海
                Array(1052159, 50, 1, 1),*/
				/*************
				帽子
				*************/
				//永恒冠军盔
                Array(1002776, 50, 1, 1),
				//永恒玄妙帽
                Array(1002777, 50, 1, 1),
				//永恒霓翎帽
                Array(1002778, 50, 1, 1),
				//永恒迷踪帽
                Array(1002779, 50, 1, 1),
				//永恒海王星
                Array(1002780, 50, 1, 1),
				/*************
				武器
				*************/
				//永恒破甲剑
                Array(1302081, 50, 1, 1),
				//永恒断蚺斧
                Array(1312037, 50, 1, 1),
				//永恒惊破天
                Array(1322060, 50, 1, 1),
				//永恒狂鲨锯
                Array(1332073, 50, 1, 1),
				//永恒断首刃
				Array(1332074, 50, 1, 1),
				//永恒蝶翼杖
                Array(1372044, 50, 1, 1),
				//永恒冰轮杖
                Array(1382057, 50, 1, 1),
				//永恒玄冥剑
                Array(1402046, 50, 1, 1),
				//永恒碎鼋斧
                Array(1412033, 50, 1, 1),
				//永恒威震天
                Array(1422037, 50, 1, 1),
				//永恒显圣枪
                Array(1432047, 50, 1, 1),
				//永恒神光戟
                Array(1442063, 50, 1, 1),
				//永恒惊电弓
                Array(1452057, 50, 1, 1),
				//永恒冥雷弩
                Array(1462050, 50, 1, 1),
				//永恒大悲赋
                Array(1472068, 50, 1, 1),
				//永恒孔雀翎
                Array(1482023, 50, 1, 1),
				//永恒凤凰铳
                Array(1492023, 50, 1, 1)
                );

function start() {
    status = -1;
    action(1, 0, 0);
}

function action(mode, type, selection) {
    if (mode == 1) {
        status++;
    } else {
        status--;
    }
	if (cm.getInventory(1).isFull()) {
		cm.给物品(4280000,1);
		cm.给物品(5490000,1);
        cm.说明文字("请保证 #b装备栏#k 至少有2个位置。");
        cm.对话结束();
        return;
    } else if (cm.getInventory(2).isFull()) {
		cm.给物品(4280000,1);
		cm.给物品(5490000,1);
        cm.说明文字("请保证 #b消耗栏#k 至少有2个位置。");
        cm.对话结束();
        return;
    } else if (cm.getInventory(3).isFull()) {
		cm.给物品(4280000,1);
		cm.给物品(5490000,1);
        cm.说明文字("请保证 #b设置栏#k 至少有2个位置。");
        cm.对话结束();
        return;
    } else if (cm.getInventory(4).isFull()) {
		cm.给物品(4280000,1);
		cm.给物品(5490000,1);
        cm.说明文字("请保证 #b其他栏#k 至少有2个位置。");
        cm.对话结束();
        return;
    } else if (cm.getInventory(5).isFull()) {
		cm.给物品(4280000,1);
		cm.给物品(5490000,1);
        cm.说明文字("请保证 #b特殊栏#k 至少有2个位置。");
        cm.对话结束();
        return;
    }

	if (status == 0) {
        var chance = Math.floor(Math.random() * +1000);
        var finalitem = Array();
        for (var i = 0; i < itemList.length; i++) {
            if (itemList[i][1] >= chance) {
                finalitem.push(itemList[i]);
            }
        }
        if (finalitem.length != 0) {
            if (finalitem.length == 0) {
                return 1;
            }
            var item;
            var random = new java.util.Random();
            var finalchance = random.nextInt(finalitem.length);
            var itemId = finalitem[finalchance][0];
            var quantity = finalitem[finalchance][2];
            var notice = finalitem[finalchance][3];
            item = cm.gainGachaponItem2(itemId, quantity, "永恒谜之蛋", notice);
            if (item != -1) {
				cm.说明文字("恭喜你获得了 "+cm.显示物品(itemId)+" x 1");
            } else {
                cm.playerMessage(1,"请你确认在背包的装备，消耗，其他窗口中是否有一格以上的空间。");
            }
            cm.safeDispose();
        } else {
            cm.playerMessage(1,"今天的运气可真差，什么都没有拿到。");
            cm.safeDispose();
        }
        cm.对话结束();
    }
}